# 网络安全校验错误码

<!--Kit: Network Kit-->
<!--Subsystem: Communication-->
<!--Owner: @wmyao_mm-->
<!--Designer: @guo-min_net-->
<!--Tester: @tongxilin-->
<!--Adviser: @zhang_yixin13-->

> **说明：**
>
> 以下仅介绍本模块特有错误码，通用错误码请参考[通用错误码](../errorcode-universal.md)说明文档。

## 2305001 未定义的错误

**错误信息**

Unspecified error.

**错误描述**

不可预估的错误。

**处理步骤**

检查参数和输入、捕获异常、调试和日志记录。

## 2305002 获取证书颁发者失败

**错误信息**

Unable to get issuer certificate.

**错误描述**

无法获取发行证书。

**可能原因**

通常是因为证书链不完整，或者服务器配置了错误的证书。

**处理步骤**

检查是否正确设置了SSL/TLS连接，包括证书和证书链的路径，以及是否正确处理了证书验证过程。

## 2305003 获取证书吊销列表失败

**错误信息**

Unable to get certificate revocation list (CRL).

**错误描述**

无法获取证书注销列表（CRL）。

**可能原因**

通常是因为网络问题、CRL服务器配置错误或证书颁发机构服务不可用。

**处理步骤**

检查网络、确认CRL URI正确、更新CRL文件或使用在线证书状态协议 (OCSP) 进行证书状态检查。

## 2305004 无法解密证书签名

**错误信息**

Unable to decrypt certificate signature.

**错误描述**

无法解密证书签名。

**可能原因**

通常是因为缺少或错误的私钥。

**处理步骤**

检查并确保客户端有正确的私钥，且私钥与证书的公钥匹配，且私钥格式正确。

## 2305005 无法解密证书吊销列表签名

**错误信息**

Unable to decrypt CRL signature.

**错误描述**

无法解密CRL签名。

**可能原因**

CRL的加密算法不被客户端支持，或者用于加密CRL签名的密钥未被客户端识别。

**处理步骤**

检查并确保客户端有正确的私钥，且私钥与CRL的公钥匹配，且私钥格式正确。

## 2305006 无法解码颁发者公钥

**错误信息**

Unable to decode issuer public key.

**错误描述**

无法解码发行公钥。

**可能原因**

证书格式不正确，或者公钥数据损坏。

**处理步骤**

检查证书格式、检查公钥数据、重新生成证书。

## 2305007 证书签名失败

**错误信息**

Certificate signature failure.

**错误描述**

证书签名失败。

**可能原因**

证书的签名计算错误，或者证书使用的数字签名算法不被客户端支持。

**处理步骤**

1. 检查并确保证书使用的签名算法被客户端支持，证书的签名密钥与公钥匹配，且签名数据正确。
2. 重新生成或更新证书。

## 2305008 证书吊销列表签名失败

**错误信息**

CRL signature failure.

**错误描述**

CRL签名失败。

**可能原因**

CRL的签名计算错误，或者CRL使用的数字签名算法不被客户端支持。

**处理步骤**

检查CRL的签名算法、检查CRL的签名密钥、重新生成CRL、更新CRL。

## 2305009 证书尚未生效

**错误信息**

Certificate is not yet valid.

**错误描述**

证书尚未生效。

**可能原因**

证书的开始日期在当前日期之后。

**处理步骤**

检查证书的开始和结束日期，更新或重新生成证书。

## 2305010 证书已过期

**错误信息**

Certificate has expired.

**错误描述**

证书已过期。

**可能原因**

证书的结束日期在当前日期之前。

**处理步骤**

检查证书的开始和结束日期，更新或重新生成证书。

## 2305011 CRL尚未生效

**错误信息**

CRL is not yet valid.

**错误描述**

CRL尚未生效。

**可能原因**

CRL的开始日期在当前日期之后。

**处理步骤**

1. 检查并确保CRL的有效时间在开始日期和结束日期之间。
2. 重新生成或更新CRL。

## 2305012 CRL已过期

**错误信息**

CRL has expired.

**错误描述**

CRL已过期。

**可能原因**

CRL的结束日期在当前日期之前。

**处理步骤**

更新CRL以获取最新的CRL文件，使用OCSP。

## 2305018 自签名证书

**错误信息**

Self-signed certificate.

**错误描述**

自签名证书。

**可能原因**

证书的签名是由证书自身的公钥进行的，不是受信任的证书颁发机构（CA）颁发的。

**处理步骤**

检查证书来源、添加自签名证书为受信任的CA。

## 2305020 无法获取本地证书

**错误信息**

Unable to get local issuer certificate.

**错误描述**

无法获取本地证书颁发机构证书。

**可能原因**

因为客户端的证书存储或配置问题。

**处理步骤**

1. 检查证书存储，确认客户端有正确的CA证书。
2. 更新证书。
3. 检查网络连接。
4. 重新配置客户端。

## 2305023 证书已被吊销

**错误信息**

Certificate has been revoked.

**错误描述**

该证书已被吊销。

**可能原因**

证书存在过期、被吊销或证书链不完整等问题。

**处理步骤**

检查证书状态，是否被吊销；如果证书被吊销，更新为未被吊销的证书。

## 2305024 无效的证书颁发机构（CA）

**错误信息**

Invalid certificate authority (CA).

**错误描述**

无效的证书颁发机构（CA）。

**可能原因**

通常是因为CA的证书已过期或被吊销，或者系统未包含该CA的证书。

**处理步骤**

确保证书是由受信任的CA颁发的；如果证书是由不受信任的CA颁发的，需要更新为由受信任的CA颁发的证书。

## 2305027 证书不可信

**错误信息**

Certificate is untrusted.

**错误描述**

证书不受信任。

**可能原因**

通常是因为证书由不受信任的证书颁发机构（CA）签发，或者证书已被吊销。

**处理步骤**

1. 确保证书由可信的证书颁发机构（CA）颁发。
2. 确保证书的签名密钥与客户端的预期密钥匹配。
3. 如果证书由不可信的CA颁发，需要更新为由可信的CA颁发的证书。

## 2305069 无效的证书验证上下文

**错误信息**

Invalid certificate verification context.

**错误描述**

无效的证书验证上下文。

**可能原因**

可能的原因包括但不限于：证书链构建有误，缺少中间证书；证书的公钥无法与私钥匹配；证书的签名验证失败；证书的主机名不匹配。

**处理步骤**

需要检查证书链并确保所有的证书和签名都正确无误。
